conceptLinks:
  Helm Repositories: "#lesson-helm-repos"
  Helm Install: "#lesson-helm-install"
  Release Management: "#lesson-release-management"
  Values Overrides: "#lesson-values-overrides"
  Inspecting Charts: "#lesson-inspecting-charts"
  Helm Concepts: "#lesson-helm-concepts"

variants:
  warmups:
    - id: warmup_1
      concept: Helm Repositories
      variants:
        - id: v1
          title: Add a Helm Repository
          description: Write the command to add the Bitnami Helm chart repository with the URL <code>https://charts.bitnami.com/bitnami</code>.
          hints:
            - "Use <code>helm repo add &lt;name&gt; &lt;url&gt;</code>."
          solution: |-
            helm repo add bitnami https://charts.bitnami.com/bitnami
        - id: v2
          title: Update All Repositories
          description: Write the command to update all locally cached Helm chart repository indexes.
          hints:
            - "The subcommand is <code>helm repo update</code>."
          solution: |-
            helm repo update
        - id: v3
          title: List Configured Repositories
          description: Write the command to list all Helm chart repositories currently configured on your system.
          hints:
            - "Use <code>helm repo list</code>."
          solution: |-
            helm repo list
        - id: v4
          title: Search a Repository for Charts
          description: Write the command to search the configured repositories for charts related to <code>nginx</code>.
          hints:
            - "Use <code>helm search repo &lt;keyword&gt;</code>."
          solution: |-
            helm search repo nginx
        - id: v5
          title: Remove a Repository
          description: Write the command to remove the Helm repository named <code>bitnami</code> from your local configuration.
          hints:
            - "Use <code>helm repo remove &lt;name&gt;</code>."
          solution: |-
            helm repo remove bitnami
        - id: v6
          title: Search Artifact Hub
          description: Write the command to search Artifact Hub for charts related to <code>prometheus</code>.
          hints:
            - "Use <code>helm search hub &lt;keyword&gt;</code> to search the public Artifact Hub."
          solution: |-
            helm search hub prometheus
        - id: v7
          title: Add a Repository with Custom Name
          description: Write the command to add the Ingress-NGINX repository (<code>https://kubernetes.github.io/ingress-nginx</code>) with the name <code>ingress-nginx</code>.
          hints:
            - "The first argument after <code>helm repo add</code> is the local name you choose."
          solution: |-
            helm repo add ingress-nginx https://kubernetes.github.io/ingress-nginx
        - id: v8
          title: Search for All Versions
          description: Write the command to search the configured repositories for all available versions of the <code>nginx</code> chart.
          hints:
            - "Add the <code>--versions</code> flag to <code>helm search repo</code>."
          solution: |-
            helm search repo nginx --versions
        - id: v9
          title: Add Repo and Update
          description: Write the commands to add the Jetstack repository (<code>https://charts.jetstack.io</code>) and then update all repository indexes.
          hints:
            - "Chain two commands: <code>helm repo add</code> followed by <code>helm repo update</code>."
          solution: |-
            helm repo add jetstack https://charts.jetstack.io
            helm repo update
        - id: v10
          title: Search for a Specific Chart Version
          description: Write the command to search for the <code>bitnami/mysql</code> chart and show only versions matching <code>9.</code> in the version string.
          hints:
            - "Use <code>helm search repo</code> with the <code>--version</code> flag to specify a version constraint."
          solution: |-
            helm search repo bitnami/mysql --version "~9"
        - id: v11
          title: Add an OCI Registry
          description: Write the command to log in to an OCI-compatible Helm registry at <code>registry.example.com</code>.
          hints:
            - "Use <code>helm registry login &lt;host&gt;</code>."
          solution: |-
            helm registry login registry.example.com
        - id: v12
          title: Verify Repository Configuration
          description: After adding a new repository, write the command to verify it appears in your configured repositories and then refresh its index.
          hints:
            - "Use <code>helm repo list</code> to check, then <code>helm repo update</code> to refresh."
          solution: |-
            helm repo list
            helm repo update

    - id: warmup_2
      concept: Helm Install
      variants:
        - id: v1
          title: Basic Chart Install
          description: Write the command to install the <code>bitnami/nginx</code> chart with the release name <code>my-nginx</code>.
          hints:
            - "Use <code>helm install &lt;release-name&gt; &lt;chart&gt;</code>."
          solution: |-
            helm install my-nginx bitnami/nginx
        - id: v2
          title: Install into a Namespace
          description: Write the command to install <code>bitnami/redis</code> with release name <code>my-redis</code> into the <code>cache</code> namespace.
          hints:
            - "Add the <code>--namespace</code> flag."
          solution: |-
            helm install my-redis bitnami/redis --namespace cache
        - id: v3
          title: Install with --set Flag
          description: Write the command to install <code>bitnami/nginx</code> as <code>web</code>, overriding the replica count to 3.
          hints:
            - "Use <code>--set replicaCount=3</code>."
          solution: |-
            helm install web bitnami/nginx --set replicaCount=3
        - id: v4
          title: Install with a Values File
          description: Write the command to install <code>bitnami/postgresql</code> as <code>my-db</code> using a custom values file called <code>db-values.yaml</code>.
          hints:
            - "Use <code>-f &lt;file&gt;</code> or <code>--values &lt;file&gt;</code>."
          solution: |-
            helm install my-db bitnami/postgresql -f db-values.yaml
        - id: v5
          title: Install with --create-namespace
          description: Write the command to install <code>bitnami/redis</code> as <code>my-redis</code> into a namespace called <code>data</code>, creating the namespace if it does not exist.
          hints:
            - "Combine <code>--namespace</code> and <code>--create-namespace</code>."
          solution: |-
            helm install my-redis bitnami/redis --namespace data --create-namespace
        - id: v6
          title: Dry Run Install
          description: Write the command to perform a dry-run install of <code>bitnami/nginx</code> as <code>test-release</code> to preview the rendered manifests without actually installing.
          hints:
            - "Add <code>--dry-run</code> to the install command."
          solution: |-
            helm install test-release bitnami/nginx --dry-run
        - id: v7
          title: Install a Specific Chart Version
          description: Write the command to install version <code>14.2.1</code> of the <code>bitnami/nginx</code> chart as <code>my-nginx</code>.
          hints:
            - "Use the <code>--version</code> flag to pin a chart version."
          solution: |-
            helm install my-nginx bitnami/nginx --version 14.2.1
        - id: v8
          title: Install with Multiple --set Flags
          description: Write the command to install <code>bitnami/nginx</code> as <code>web</code>, setting both <code>replicaCount=3</code> and <code>service.type=ClusterIP</code>.
          hints:
            - "You can use <code>--set</code> multiple times in the same command."
          solution: |-
            helm install web bitnami/nginx --set replicaCount=3 --set service.type=ClusterIP
        - id: v9
          title: Install with Generated Name
          description: Write the command to install <code>bitnami/nginx</code> and let Helm auto-generate the release name.
          hints:
            - "Use the <code>--generate-name</code> flag instead of providing a release name."
          solution: |-
            helm install bitnami/nginx --generate-name
        - id: v10
          title: Install and Wait for Ready
          description: Write the command to install <code>bitnami/nginx</code> as <code>my-nginx</code> and wait for all resources to be ready before marking the release as successful.
          hints:
            - "Add <code>--wait</code> to block until pods are ready."
          solution: |-
            helm install my-nginx bitnami/nginx --wait
        - id: v11
          title: Install with Timeout
          description: Write the command to install <code>bitnami/postgresql</code> as <code>my-db</code> with a 10-minute timeout, waiting for readiness.
          hints:
            - "Combine <code>--wait</code> with <code>--timeout 10m</code>."
          solution: |-
            helm install my-db bitnami/postgresql --wait --timeout 10m
        - id: v12
          title: Install from a Local Chart Directory
          description: Write the command to install a chart from the local directory <code>./my-chart</code> with the release name <code>local-app</code>.
          hints:
            - "The chart path can be a local directory instead of a repository reference."
          solution: |-
            helm install local-app ./my-chart
        - id: v13
          title: Install with Values File and --set Override
          description: Write the command to install <code>bitnami/nginx</code> as <code>web</code> using <code>values.yaml</code> but overriding <code>service.type</code> to <code>LoadBalancer</code>.
          hints:
            - "Values from <code>--set</code> take precedence over values from <code>-f</code>."
          solution: |-
            helm install web bitnami/nginx -f values.yaml --set service.type=LoadBalancer

    - id: warmup_3
      concept: Release Management
      variants:
        - id: v1
          title: List All Releases
          description: Write the command to list all Helm releases in the current namespace.
          hints:
            - "Use <code>helm list</code> or <code>helm ls</code>."
          solution: |-
            helm list
        - id: v2
          title: List Releases in All Namespaces
          description: Write the command to list Helm releases across all namespaces.
          hints:
            - "Add <code>--all-namespaces</code> or <code>-A</code> to <code>helm list</code>."
          solution: |-
            helm list --all-namespaces
        - id: v3
          title: Check Release Status
          description: Write the command to check the current status of a Helm release named <code>my-nginx</code>.
          hints:
            - "Use <code>helm status &lt;release-name&gt;</code>."
          solution: |-
            helm status my-nginx
        - id: v4
          title: View Release History
          description: Write the command to view the revision history of a Helm release named <code>my-app</code>.
          hints:
            - "Use <code>helm history &lt;release-name&gt;</code>."
          solution: |-
            helm history my-app
        - id: v5
          title: Upgrade a Release
          description: Write the command to upgrade the release <code>my-nginx</code> to the latest version of <code>bitnami/nginx</code>.
          hints:
            - "Use <code>helm upgrade &lt;release-name&gt; &lt;chart&gt;</code>."
          solution: |-
            helm upgrade my-nginx bitnami/nginx
        - id: v6
          title: Rollback a Release
          description: Write the command to rollback the release <code>my-app</code> to revision <code>2</code>.
          hints:
            - "Use <code>helm rollback &lt;release-name&gt; &lt;revision&gt;</code>."
          solution: |-
            helm rollback my-app 2
        - id: v7
          title: Uninstall a Release
          description: Write the command to uninstall (delete) the release named <code>my-nginx</code>.
          hints:
            - "Use <code>helm uninstall &lt;release-name&gt;</code>."
          solution: |-
            helm uninstall my-nginx
        - id: v8
          title: Upgrade with --set
          description: Write the command to upgrade the release <code>web</code> using <code>bitnami/nginx</code> and change the replica count to 5.
          hints:
            - "Combine <code>helm upgrade</code> with <code>--set replicaCount=5</code>."
          solution: |-
            helm upgrade web bitnami/nginx --set replicaCount=5
        - id: v9
          title: Upgrade with --install
          description: Write the command to upgrade the release <code>my-app</code> using <code>bitnami/nginx</code>, installing it if it does not already exist.
          hints:
            - "Add <code>--install</code> to <code>helm upgrade</code> for an atomic install-or-upgrade."
          solution: |-
            helm upgrade --install my-app bitnami/nginx
        - id: v10
          title: Uninstall and Keep History
          description: Write the command to uninstall the release <code>my-app</code> but keep its release history for auditing.
          hints:
            - "Add <code>--keep-history</code> to <code>helm uninstall</code>."
          solution: |-
            helm uninstall my-app --keep-history
        - id: v11
          title: List Releases with Filter
          description: Write the command to list all Helm releases whose names contain <code>nginx</code>.
          hints:
            - "Use <code>helm list --filter &lt;regex&gt;</code>."
          solution: |-
            helm list --filter "nginx"
        - id: v12
          title: Rollback to Previous Revision
          description: Write the command to rollback the release <code>web</code> to its immediately previous revision.
          hints:
            - "Use revision <code>0</code> to roll back to the previous release, or omit the revision number."
          solution: |-
            helm rollback web 0

    - id: warmup_4
      concept: Inspecting Charts
      variants:
        - id: v1
          title: Show Chart Values
          description: Write the command to display the default values of the <code>bitnami/nginx</code> chart.
          hints:
            - "Use <code>helm show values &lt;chart&gt;</code>."
          solution: |-
            helm show values bitnami/nginx
        - id: v2
          title: Show Chart Metadata
          description: Write the command to display the Chart.yaml metadata for <code>bitnami/nginx</code>.
          hints:
            - "Use <code>helm show chart &lt;chart&gt;</code>."
          solution: |-
            helm show chart bitnami/nginx
        - id: v3
          title: Show Chart README
          description: Write the command to display the README of the <code>bitnami/postgresql</code> chart.
          hints:
            - "Use <code>helm show readme &lt;chart&gt;</code>."
          solution: |-
            helm show readme bitnami/postgresql
        - id: v4
          title: Show All Chart Info
          description: Write the command to show all available information (values, chart metadata, and README) for <code>bitnami/redis</code>.
          hints:
            - "Use <code>helm show all &lt;chart&gt;</code>."
          solution: |-
            helm show all bitnami/redis
        - id: v5
          title: Render Templates Locally
          description: Write the command to render the templates of the <code>bitnami/nginx</code> chart locally without installing, using the release name <code>my-nginx</code>.
          hints:
            - "Use <code>helm template &lt;release-name&gt; &lt;chart&gt;</code>."
          solution: |-
            helm template my-nginx bitnami/nginx
        - id: v6
          title: Get Manifest of a Release
          description: Write the command to get the rendered Kubernetes manifests for the deployed release <code>my-nginx</code>.
          hints:
            - "Use <code>helm get manifest &lt;release-name&gt;</code>."
          solution: |-
            helm get manifest my-nginx
        - id: v7
          title: Get Values of a Release
          description: Write the command to get the user-supplied values for the deployed release <code>my-app</code>.
          hints:
            - "Use <code>helm get values &lt;release-name&gt;</code>."
          solution: |-
            helm get values my-app
        - id: v8
          title: Get All Release Info
          description: Write the command to get all information (hooks, manifest, notes, values) for the release <code>my-app</code>.
          hints:
            - "Use <code>helm get all &lt;release-name&gt;</code>."
          solution: |-
            helm get all my-app
        - id: v9
          title: Template with Value Override
          description: Write the command to render <code>bitnami/nginx</code> templates locally as <code>test</code> with <code>replicaCount=2</code>.
          hints:
            - "Combine <code>helm template</code> with <code>--set</code>."
          solution: |-
            helm template test bitnami/nginx --set replicaCount=2
        - id: v10
          title: Get Computed Values
          description: Write the command to get all computed values (user-supplied merged with defaults) for the release <code>my-app</code>.
          hints:
            - "Add the <code>--all</code> flag to <code>helm get values</code>."
          solution: |-
            helm get values my-app --all
        - id: v11
          title: Show Values for Specific Version
          description: Write the command to show the default values for version <code>14.2.1</code> of the <code>bitnami/nginx</code> chart.
          hints:
            - "Add <code>--version</code> to <code>helm show values</code>."
          solution: |-
            helm show values bitnami/nginx --version 14.2.1
        - id: v12
          title: Template with Values File
          description: Write the command to render <code>bitnami/nginx</code> templates as <code>staging</code> using the values file <code>staging-values.yaml</code>.
          hints:
            - "Combine <code>helm template</code> with <code>-f</code>."
          solution: |-
            helm template staging bitnami/nginx -f staging-values.yaml
        - id: v13
          title: Get Release Notes
          description: Write the command to get the notes (post-install instructions) for the deployed release <code>my-nginx</code>.
          hints:
            - "Use <code>helm get notes &lt;release-name&gt;</code>."
          solution: |-
            helm get notes my-nginx

  challenges:
    - id: challenge_1
      block: 1
      difficulty: 1
      concept: Release Management
      variants:
        - id: v1
          title: Full Release Lifecycle
          description: >-
            Walk through a complete Helm release lifecycle: install <code>bitnami/nginx</code> as <code>web-app</code>
            in the <code>production</code> namespace (creating the namespace), upgrade it to set <code>replicaCount=3</code>,
            then rollback to revision 1, and finally uninstall it.
          functionSignature: "helm install / upgrade / rollback / uninstall"
          testCases:
            - input: "Install bitnami/nginx as web-app in production namespace (create namespace)"
              output: "helm install web-app bitnami/nginx --namespace production --create-namespace"
            - input: "Upgrade web-app to replicaCount=3"
              output: "helm upgrade web-app bitnami/nginx --set replicaCount=3 --namespace production"
            - input: "Rollback web-app to revision 1"
              output: "helm rollback web-app 1 --namespace production"
            - input: "Uninstall web-app"
              output: "helm uninstall web-app --namespace production"
          hints:
            - title: "\U0001F914 Think about it"
              content: >-
                A Helm release lifecycle has four key stages: install, upgrade, rollback, and uninstall.
                Each command requires the release name, and namespace must be consistent across all operations.
            - title: "\U0001F4A1 Hint"
              content: >-
                Use <code>--create-namespace</code> with install so the namespace is created automatically.
                For upgrade, pass the same chart reference and add <code>--set</code> overrides.
                Rollback takes a revision number. Uninstall removes all resources.
            - title: "\U0001F527 Pattern"
              content: |-
                <pre>1. helm install &lt;name&gt; &lt;chart&gt; --namespace &lt;ns&gt; --create-namespace
                2. helm upgrade &lt;name&gt; &lt;chart&gt; --set key=value --namespace &lt;ns&gt;
                3. helm rollback &lt;name&gt; &lt;revision&gt; --namespace &lt;ns&gt;
                4. helm uninstall &lt;name&gt; --namespace &lt;ns&gt;</pre>
          solution: |-
            # Step 1: Install
            helm install web-app bitnami/nginx --namespace production --create-namespace

            # Step 2: Upgrade with new values
            helm upgrade web-app bitnami/nginx --set replicaCount=3 --namespace production

            # Step 3: Rollback to revision 1
            helm rollback web-app 1 --namespace production

            # Step 4: Uninstall
            helm uninstall web-app --namespace production
          difficulty: 1
        - id: v2
          title: Lifecycle with Values File
          description: >-
            Manage a PostgreSQL release: install <code>bitnami/postgresql</code> as <code>my-db</code> in the <code>database</code>
            namespace using <code>db-values.yaml</code>, upgrade it by adding <code>--set primary.persistence.size=50Gi</code>,
            check the release history, then rollback to revision 1.
          functionSignature: "helm install / upgrade / history / rollback"
          testCases:
            - input: "Install with values file in database namespace"
              output: "helm install my-db bitnami/postgresql -f db-values.yaml --namespace database --create-namespace"
            - input: "Upgrade with additional --set override"
              output: "helm upgrade my-db bitnami/postgresql -f db-values.yaml --set primary.persistence.size=50Gi --namespace database"
            - input: "Check release history"
              output: "helm history my-db --namespace database"
            - input: "Rollback to revision 1"
              output: "helm rollback my-db 1 --namespace database"
          hints:
            - title: "\U0001F914 Think about it"
              content: >-
                When upgrading, you typically want to keep the original values file and add new overrides on top.
                The <code>--set</code> flag takes precedence over values files.
            - title: "\U0001F4A1 Hint"
              content: >-
                Include <code>-f db-values.yaml</code> in both install and upgrade so your base configuration persists.
                Use <code>helm history</code> to verify revision numbers before rolling back.
            - title: "\U0001F527 Pattern"
              content: |-
                <pre>1. helm install &lt;name&gt; &lt;chart&gt; -f values.yaml --namespace &lt;ns&gt; --create-namespace
                2. helm upgrade &lt;name&gt; &lt;chart&gt; -f values.yaml --set key=value --namespace &lt;ns&gt;
                3. helm history &lt;name&gt; --namespace &lt;ns&gt;
                4. helm rollback &lt;name&gt; &lt;revision&gt; --namespace &lt;ns&gt;</pre>
          solution: |-
            # Step 1: Install with values file
            helm install my-db bitnami/postgresql -f db-values.yaml --namespace database --create-namespace

            # Step 2: Upgrade with additional value
            helm upgrade my-db bitnami/postgresql -f db-values.yaml --set primary.persistence.size=50Gi --namespace database

            # Step 3: Check history
            helm history my-db --namespace database

            # Step 4: Rollback
            helm rollback my-db 1 --namespace database
          difficulty: 1
        - id: v3
          title: Install-or-Upgrade Pattern
          description: >-
            Write a single command that installs <code>bitnami/redis</code> as <code>cache</code> if it does not exist,
            or upgrades it if it does. Use the <code>staging</code> namespace (create if needed), set
            <code>architecture=standalone</code>, and wait for the release to be ready with a 5-minute timeout.
          functionSignature: "helm upgrade --install"
          testCases:
            - input: "Install-or-upgrade redis in staging namespace, standalone mode, wait 5m"
              output: "helm upgrade --install cache bitnami/redis --namespace staging --create-namespace --set architecture=standalone --wait --timeout 5m"
          hints:
            - title: "\U0001F914 Think about it"
              content: >-
                The <code>helm upgrade --install</code> pattern is idempotent: it installs the release if
                it does not exist and upgrades it if it does. This is the preferred pattern for CI/CD pipelines.
            - title: "\U0001F4A1 Hint"
              content: >-
                Combine <code>--install</code>, <code>--create-namespace</code>, <code>--wait</code>,
                and <code>--timeout</code> with <code>helm upgrade</code>.
            - title: "\U0001F527 Pattern"
              content: |-
                <pre>helm upgrade --install &lt;name&gt; &lt;chart&gt; \
                  --namespace &lt;ns&gt; --create-namespace \
                  --set key=value \
                  --wait --timeout &lt;duration&gt;</pre>
          solution: |-
            helm upgrade --install cache bitnami/redis \
              --namespace staging --create-namespace \
              --set architecture=standalone \
              --wait --timeout 5m
          difficulty: 2
        - id: v4
          title: Atomic Upgrade with Rollback
          description: >-
            Write the command to upgrade the release <code>api-server</code> in the <code>production</code> namespace
            using <code>bitnami/nginx</code> with <code>prod-values.yaml</code>. If the upgrade fails, it should
            automatically rollback. Wait for readiness with a 3-minute timeout.
          functionSignature: "helm upgrade --atomic"
          testCases:
            - input: "Atomic upgrade with auto-rollback on failure"
              output: "helm upgrade api-server bitnami/nginx -f prod-values.yaml --namespace production --atomic --timeout 3m"
          hints:
            - title: "\U0001F914 Think about it"
              content: >-
                The <code>--atomic</code> flag combines <code>--wait</code> with automatic rollback on failure.
                This is critical for production deployments.
            - title: "\U0001F4A1 Hint"
              content: >-
                Use <code>--atomic</code> instead of <code>--wait</code>. It implies <code>--wait</code> and adds
                automatic rollback if the upgrade fails.
            - title: "\U0001F527 Pattern"
              content: |-
                <pre>helm upgrade &lt;name&gt; &lt;chart&gt; \
                  -f values.yaml \
                  --namespace &lt;ns&gt; \
                  --atomic --timeout &lt;duration&gt;</pre>
          solution: |-
            helm upgrade api-server bitnami/nginx \
              -f prod-values.yaml \
              --namespace production \
              --atomic --timeout 3m
          difficulty: 2
        - id: v5
          title: Multi-Environment Release
          description: >-
            Write the commands to deploy <code>bitnami/nginx</code> as <code>frontend</code> to three environments:
            <code>dev</code> (1 replica), <code>staging</code> (2 replicas), and <code>production</code> (3 replicas).
            Each environment is a separate namespace. Create namespaces as needed.
          functionSignature: "helm install (x3)"
          testCases:
            - input: "Deploy to dev with 1 replica"
              output: "helm install frontend bitnami/nginx --namespace dev --create-namespace --set replicaCount=1"
            - input: "Deploy to staging with 2 replicas"
              output: "helm install frontend bitnami/nginx --namespace staging --create-namespace --set replicaCount=2"
            - input: "Deploy to production with 3 replicas"
              output: "helm install frontend bitnami/nginx --namespace production --create-namespace --set replicaCount=3"
          hints:
            - title: "\U0001F914 Think about it"
              content: >-
                Helm release names are scoped to a namespace, so you can reuse the same release name across
                different namespaces. Each namespace gets its own independent release.
            - title: "\U0001F4A1 Hint"
              content: >-
                Use the same release name <code>frontend</code> in each namespace. The <code>--namespace</code> flag
                isolates the releases from each other.
            - title: "\U0001F527 Pattern"
              content: |-
                <pre>For each environment:
                  helm install &lt;name&gt; &lt;chart&gt; \
                    --namespace &lt;env&gt; --create-namespace \
                    --set replicaCount=&lt;N&gt;</pre>
          solution: |-
            # Dev environment
            helm install frontend bitnami/nginx --namespace dev --create-namespace --set replicaCount=1

            # Staging environment
            helm install frontend bitnami/nginx --namespace staging --create-namespace --set replicaCount=2

            # Production environment
            helm install frontend bitnami/nginx --namespace production --create-namespace --set replicaCount=3
          difficulty: 2
        - id: v6
          title: Inspect Before Upgrade
          description: >-
            Before upgrading the release <code>my-app</code> in the <code>production</code> namespace, write the commands
            to: check the current status, view the release history, see the currently applied values, then perform
            a dry-run upgrade with <code>bitnami/nginx</code> using <code>new-values.yaml</code>.
          functionSignature: "helm status / history / get values / upgrade --dry-run"
          testCases:
            - input: "Check status"
              output: "helm status my-app --namespace production"
            - input: "View history"
              output: "helm history my-app --namespace production"
            - input: "Get current values"
              output: "helm get values my-app --namespace production"
            - input: "Dry-run upgrade"
              output: "helm upgrade my-app bitnami/nginx -f new-values.yaml --namespace production --dry-run"
          hints:
            - title: "\U0001F914 Think about it"
              content: >-
                Before making changes in production, you should always inspect the current state.
                A dry-run lets you preview the rendered manifests before committing to the upgrade.
            - title: "\U0001F4A1 Hint"
              content: >-
                Use <code>helm status</code>, <code>helm history</code>, and <code>helm get values</code> for
                inspection, then <code>helm upgrade --dry-run</code> to preview changes.
            - title: "\U0001F527 Pattern"
              content: |-
                <pre>1. helm status &lt;name&gt; --namespace &lt;ns&gt;
                2. helm history &lt;name&gt; --namespace &lt;ns&gt;
                3. helm get values &lt;name&gt; --namespace &lt;ns&gt;
                4. helm upgrade &lt;name&gt; &lt;chart&gt; -f values.yaml --namespace &lt;ns&gt; --dry-run</pre>
          solution: |-
            # Check current status
            helm status my-app --namespace production

            # View revision history
            helm history my-app --namespace production

            # See currently applied values
            helm get values my-app --namespace production

            # Preview the upgrade with dry-run
            helm upgrade my-app bitnami/nginx -f new-values.yaml --namespace production --dry-run
          difficulty: 3
        - id: v7
          title: Rollback After Failed Upgrade
          description: >-
            The release <code>api</code> in namespace <code>production</code> was upgraded and pods are crashing.
            Write the commands to: check the release history, identify the last successful revision, rollback to
            revision 3, and verify the rollback succeeded.
          functionSignature: "helm history / rollback / status"
          testCases:
            - input: "Check revision history"
              output: "helm history api --namespace production"
            - input: "Rollback to revision 3"
              output: "helm rollback api 3 --namespace production"
            - input: "Verify rollback status"
              output: "helm status api --namespace production"
          hints:
            - title: "\U0001F914 Think about it"
              content: >-
                Use <code>helm history</code> to see all revisions and their statuses.
                The last revision with status <code>deployed</code> or <code>superseded</code> before the
                failed one is the target for rollback.
            - title: "\U0001F4A1 Hint"
              content: >-
                <code>helm rollback</code> creates a new revision, so after rollback you should verify
                with <code>helm status</code> that the release is healthy again.
            - title: "\U0001F527 Pattern"
              content: |-
                <pre>1. helm history &lt;name&gt; --namespace &lt;ns&gt;  (find last good revision)
                2. helm rollback &lt;name&gt; &lt;revision&gt; --namespace &lt;ns&gt;
                3. helm status &lt;name&gt; --namespace &lt;ns&gt;  (verify health)</pre>
          solution: |-
            # Check revision history to find the last good revision
            helm history api --namespace production

            # Rollback to the known-good revision 3
            helm rollback api 3 --namespace production

            # Verify the rollback was successful
            helm status api --namespace production
          difficulty: 2

    - id: challenge_2
      block: 1
      difficulty: 2
      concept: Values Overrides
      variants:
        - id: v1
          title: Set Nested Values
          description: >-
            Write the <code>helm install</code> command for <code>bitnami/nginx</code> as <code>web</code> that sets
            the following nested values using <code>--set</code>: <code>service.type=LoadBalancer</code>,
            <code>service.ports.http=8080</code>, and <code>resources.requests.memory=256Mi</code>.
          functionSignature: "helm install --set (nested)"
          testCases:
            - input: "Set service.type, service.ports.http, and resources.requests.memory"
              output: "helm install web bitnami/nginx --set service.type=LoadBalancer --set service.ports.http=8080 --set resources.requests.memory=256Mi"
          hints:
            - title: "\U0001F914 Think about it"
              content: >-
                Helm uses dot notation for nested YAML paths. <code>--set a.b.c=value</code> translates to
                <code>a: b: c: value</code> in YAML.
            - title: "\U0001F4A1 Hint"
              content: >-
                Each nested key is separated by a dot. Use multiple <code>--set</code> flags, one for each value
                you want to override.
            - title: "\U0001F527 Pattern"
              content: |-
                <pre>helm install &lt;name&gt; &lt;chart&gt; \
                  --set parent.child=value \
                  --set parent.child.grandchild=value</pre>
          solution: |-
            helm install web bitnami/nginx \
              --set service.type=LoadBalancer \
              --set service.ports.http=8080 \
              --set resources.requests.memory=256Mi
          difficulty: 2
        - id: v2
          title: Set String Values
          description: >-
            Write the <code>helm install</code> command for <code>bitnami/nginx</code> as <code>web</code> that sets
            the annotation <code>ingress.annotations.nginx\.ingress\.kubernetes\.io/rewrite-target=/</code> using
            <code>--set-string</code> to ensure the value is treated as a string.
          functionSignature: "helm install --set-string"
          testCases:
            - input: "Set an annotation value as a string"
              output: "helm install web bitnami/nginx --set-string ingress.annotations.nginx\\.ingress\\.kubernetes\\.io/rewrite-target=/"
          hints:
            - title: "\U0001F914 Think about it"
              content: >-
                Helm's <code>--set</code> tries to interpret values as their natural types (numbers, booleans).
                Use <code>--set-string</code> when you need the value to always be a string.
                Keys containing dots must have those dots escaped with backslashes.
            - title: "\U0001F4A1 Hint"
              content: >-
                Escape literal dots in key names with <code>\\.</code> so Helm does not interpret them as
                nested path separators.
            - title: "\U0001F527 Pattern"
              content: |-
                <pre>helm install &lt;name&gt; &lt;chart&gt; \
                  --set-string key\\.with\\.dots=value</pre>
          solution: |-
            helm install web bitnami/nginx \
              --set-string ingress.annotations.nginx\\.ingress\\.kubernetes\\.io/rewrite-target=/
          difficulty: 3
        - id: v3
          title: Set Array Values
          description: >-
            Write the <code>helm install</code> command for <code>bitnami/nginx</code> as <code>web</code> that
            sets an array of <code>extraEnvVars</code> with two entries:
            <code>extraEnvVars[0].name=APP_ENV</code>, <code>extraEnvVars[0].value=production</code>,
            <code>extraEnvVars[1].name=LOG_LEVEL</code>, <code>extraEnvVars[1].value=info</code>.
          functionSignature: "helm install --set (array)"
          testCases:
            - input: "Set array of environment variables"
              output: "helm install web bitnami/nginx --set extraEnvVars[0].name=APP_ENV --set extraEnvVars[0].value=production --set extraEnvVars[1].name=LOG_LEVEL --set extraEnvVars[1].value=info"
          hints:
            - title: "\U0001F914 Think about it"
              content: >-
                Helm uses bracket notation for array indices: <code>--set list[0].key=value</code>.
                Each array element is referenced by its zero-based index.
            - title: "\U0001F4A1 Hint"
              content: >-
                Set each field of each array element individually using <code>arrayName[index].field=value</code>.
            - title: "\U0001F527 Pattern"
              content: |-
                <pre>helm install &lt;name&gt; &lt;chart&gt; \
                  --set items[0].key=val1 \
                  --set items[0].other=val2 \
                  --set items[1].key=val3</pre>
          solution: |-
            helm install web bitnami/nginx \
              --set extraEnvVars[0].name=APP_ENV \
              --set extraEnvVars[0].value=production \
              --set extraEnvVars[1].name=LOG_LEVEL \
              --set extraEnvVars[1].value=info
          difficulty: 2
        - id: v4
          title: Multiple Values Files
          description: >-
            Write the <code>helm upgrade --install</code> command for <code>bitnami/nginx</code> as <code>web</code>
            in the <code>staging</code> namespace using three values files in order: <code>values-base.yaml</code>,
            <code>values-staging.yaml</code>, and <code>values-secrets.yaml</code>. Later files override earlier ones.
          functionSignature: "helm upgrade --install -f (multiple)"
          testCases:
            - input: "Upgrade-or-install with three layered values files"
              output: "helm upgrade --install web bitnami/nginx -f values-base.yaml -f values-staging.yaml -f values-secrets.yaml --namespace staging"
          hints:
            - title: "\U0001F914 Think about it"
              content: >-
                When you specify multiple <code>-f</code> flags, Helm merges them left to right. Values in later
                files override values in earlier files. This lets you layer configurations.
            - title: "\U0001F4A1 Hint"
              content: >-
                Use <code>-f</code> for each file in order from most general to most specific.
                Order matters: the last file wins for any conflicting keys.
            - title: "\U0001F527 Pattern"
              content: |-
                <pre>helm upgrade --install &lt;name&gt; &lt;chart&gt; \
                  -f base-values.yaml \
                  -f env-values.yaml \
                  -f secret-values.yaml \
                  --namespace &lt;ns&gt;</pre>
          solution: |-
            helm upgrade --install web bitnami/nginx \
              -f values-base.yaml \
              -f values-staging.yaml \
              -f values-secrets.yaml \
              --namespace staging
          difficulty: 2
        - id: v5
          title: Override with --set over Values File
          description: >-
            Write the command to install <code>bitnami/postgresql</code> as <code>my-db</code> using
            <code>db-values.yaml</code> but override <code>auth.postgresPassword</code> to <code>supersecret</code>
            and <code>primary.persistence.size</code> to <code>100Gi</code> via <code>--set</code>.
          functionSignature: "helm install -f --set"
          testCases:
            - input: "Install with values file plus --set overrides"
              output: "helm install my-db bitnami/postgresql -f db-values.yaml --set auth.postgresPassword=supersecret --set primary.persistence.size=100Gi"
          hints:
            - title: "\U0001F914 Think about it"
              content: >-
                The <code>--set</code> flag has the highest precedence. It overrides both the chart's default
                values and any values files specified with <code>-f</code>.
            - title: "\U0001F4A1 Hint"
              content: >-
                Specify the values file first with <code>-f</code>, then add <code>--set</code> overrides.
                The order of flags on the command line does not change precedence: <code>--set</code> always wins.
            - title: "\U0001F527 Pattern"
              content: |-
                <pre>helm install &lt;name&gt; &lt;chart&gt; \
                  -f values.yaml \
                  --set key1=value1 \
                  --set key2=value2</pre>
          solution: |-
            helm install my-db bitnami/postgresql \
              -f db-values.yaml \
              --set auth.postgresPassword=supersecret \
              --set primary.persistence.size=100Gi
          difficulty: 2
        - id: v6
          title: Set JSON Values
          description: >-
            Write the command to install <code>bitnami/nginx</code> as <code>web</code>, setting
            <code>podAnnotations</code> to include <code>prometheus.io/scrape=true</code> and
            <code>prometheus.io/port=9113</code> using <code>--set-json</code>.
          functionSignature: "helm install --set-json"
          testCases:
            - input: "Set pod annotations using JSON syntax"
              output: "helm install web bitnami/nginx --set-json 'podAnnotations={\"prometheus.io/scrape\":\"true\",\"prometheus.io/port\":\"9113\"}'"
          hints:
            - title: "\U0001F914 Think about it"
              content: >-
                The <code>--set-json</code> flag lets you pass complex values as JSON strings, which can be
                easier than escaping dots in annotation keys with <code>--set</code>.
            - title: "\U0001F4A1 Hint"
              content: >-
                Use <code>--set-json 'key={\"nested\":\"value\"}'</code> to pass a JSON object as the value
                for a key.
            - title: "\U0001F527 Pattern"
              content: |-
                <pre>helm install &lt;name&gt; &lt;chart&gt; \
                  --set-json 'key={"subkey":"value"}'</pre>
          solution: |-
            helm install web bitnami/nginx \
              --set-json 'podAnnotations={"prometheus.io/scrape":"true","prometheus.io/port":"9113"}'
          difficulty: 3
        - id: v7
          title: Template with Values to Verify
          description: >-
            Before deploying, you want to verify your values produce the correct output. Write the command to
            render <code>bitnami/nginx</code> templates locally as <code>web</code> using <code>prod-values.yaml</code>
            with an override of <code>service.type=NodePort</code>, and output only the Service manifest.
          functionSignature: "helm template --show-only"
          testCases:
            - input: "Template with values file, --set, and filter to Service"
              output: "helm template web bitnami/nginx -f prod-values.yaml --set service.type=NodePort --show-only templates/svc.yaml"
          hints:
            - title: "\U0001F914 Think about it"
              content: >-
                <code>helm template</code> renders all templates by default. Use <code>--show-only</code> to
                render just a specific template file from the chart.
            - title: "\U0001F4A1 Hint"
              content: >-
                Combine <code>-f</code>, <code>--set</code>, and <code>--show-only templates/svc.yaml</code>
                to preview only the Service resource with your overrides applied.
            - title: "\U0001F527 Pattern"
              content: |-
                <pre>helm template &lt;name&gt; &lt;chart&gt; \
                  -f values.yaml \
                  --set key=value \
                  --show-only templates/&lt;file&gt;.yaml</pre>
          solution: |-
            helm template web bitnami/nginx \
              -f prod-values.yaml \
              --set service.type=NodePort \
              --show-only templates/svc.yaml
          difficulty: 3

    - id: challenge_3
      block: 2
      difficulty: 2
      concept: Helm Concepts
      variants:
        - id: v1
          title: Diagnose Failed Install
          description: >-
            You ran <code>helm install my-app bitnami/nginx --namespace demo</code> but it failed because the namespace
            does not exist. The release is now in a <code>failed</code> state. Write the commands to: check what
            happened, uninstall the failed release, and reinstall correctly.
          functionSignature: "helm status / uninstall / install"
          testCases:
            - input: "Check the failed release"
              output: "helm status my-app --namespace demo"
            - input: "Remove the failed release"
              output: "helm uninstall my-app --namespace demo"
            - input: "Reinstall with namespace creation"
              output: "helm install my-app bitnami/nginx --namespace demo --create-namespace"
          hints:
            - title: "\U0001F914 Think about it"
              content: >-
                A failed Helm install still creates a release record in the <code>failed</code> state. You must
                uninstall it before you can reuse the same release name. Alternatively, you could use
                <code>helm upgrade --install</code>.
            - title: "\U0001F4A1 Hint"
              content: >-
                Use <code>helm status</code> to see the failure reason, <code>helm uninstall</code> to remove
                the failed release, then reinstall with <code>--create-namespace</code>.
            - title: "\U0001F527 Pattern"
              content: |-
                <pre>1. helm status &lt;name&gt; --namespace &lt;ns&gt;  (diagnose)
                2. helm uninstall &lt;name&gt; --namespace &lt;ns&gt;  (clean up)
                3. helm install &lt;name&gt; &lt;chart&gt; --namespace &lt;ns&gt; --create-namespace  (fix)</pre>
          solution: |-
            # Diagnose the failure
            helm status my-app --namespace demo

            # Remove the failed release
            helm uninstall my-app --namespace demo

            # Reinstall with namespace creation
            helm install my-app bitnami/nginx --namespace demo --create-namespace
          difficulty: 2
        - id: v2
          title: Pending Install Stuck
          description: >-
            A release <code>stuck-app</code> in the <code>default</code> namespace shows status
            <code>pending-install</code> and the pods never became ready. Write the commands to: check the status,
            view the rendered manifests, uninstall with forced cleanup, and reinstall with a timeout and wait.
          functionSignature: "helm status / get manifest / uninstall / install --wait"
          testCases:
            - input: "Check the pending release"
              output: "helm status stuck-app"
            - input: "View the manifests Helm deployed"
              output: "helm get manifest stuck-app"
            - input: "Force-uninstall the stuck release"
              output: "helm uninstall stuck-app"
            - input: "Reinstall with wait and timeout"
              output: "helm install stuck-app bitnami/nginx --wait --timeout 5m"
          hints:
            - title: "\U0001F914 Think about it"
              content: >-
                A <code>pending-install</code> state means Helm is waiting for resources to become ready.
                This usually indicates a pod or service issue. Inspect the manifests to find configuration errors.
            - title: "\U0001F4A1 Hint"
              content: >-
                Use <code>helm get manifest</code> to see exactly what was deployed. After uninstalling,
                add <code>--wait --timeout</code> to the reinstall so Helm will report clearly if readiness
                is not achieved.
            - title: "\U0001F527 Pattern"
              content: |-
                <pre>1. helm status &lt;name&gt;  (check state)
                2. helm get manifest &lt;name&gt;  (inspect deployed resources)
                3. helm uninstall &lt;name&gt;  (clean up)
                4. helm install &lt;name&gt; &lt;chart&gt; --wait --timeout &lt;duration&gt;</pre>
          solution: |-
            # Check the stuck release status
            helm status stuck-app

            # View the manifests to identify issues
            helm get manifest stuck-app

            # Remove the stuck release
            helm uninstall stuck-app

            # Reinstall with wait and timeout for better feedback
            helm install stuck-app bitnami/nginx --wait --timeout 5m
          difficulty: 2
        - id: v3
          title: Wrong Values Applied
          description: >-
            After upgrading release <code>my-app</code> in <code>production</code>, you realize the wrong values
            were applied. Write the commands to: check what values are currently active, view the release history
            to find the correct revision, rollback to revision 4, and verify the values after rollback.
          functionSignature: "helm get values / history / rollback / get values"
          testCases:
            - input: "Check active values"
              output: "helm get values my-app --namespace production"
            - input: "View revision history"
              output: "helm history my-app --namespace production"
            - input: "Rollback to revision 4"
              output: "helm rollback my-app 4 --namespace production"
            - input: "Verify values after rollback"
              output: "helm get values my-app --namespace production"
          hints:
            - title: "\U0001F914 Think about it"
              content: >-
                Each Helm revision stores the values that were used. You can compare values across revisions
                using <code>helm get values --revision</code> to find which revision had the correct configuration.
            - title: "\U0001F4A1 Hint"
              content: >-
                Use <code>helm get values</code> to see current values, <code>helm history</code> to find the
                right revision number, <code>helm rollback</code> to revert, then <code>helm get values</code>
                again to confirm.
            - title: "\U0001F527 Pattern"
              content: |-
                <pre>1. helm get values &lt;name&gt; --namespace &lt;ns&gt;  (see current)
                2. helm history &lt;name&gt; --namespace &lt;ns&gt;  (find good revision)
                3. helm rollback &lt;name&gt; &lt;revision&gt; --namespace &lt;ns&gt;
                4. helm get values &lt;name&gt; --namespace &lt;ns&gt;  (confirm fix)</pre>
          solution: |-
            # Check the currently applied values
            helm get values my-app --namespace production

            # View history to find the correct revision
            helm history my-app --namespace production

            # Rollback to the known-good revision
            helm rollback my-app 4 --namespace production

            # Verify the values are correct after rollback
            helm get values my-app --namespace production
          difficulty: 2
        - id: v4
          title: Compare Revisions
          description: >-
            Release <code>api</code> in namespace <code>production</code> was upgraded from revision 5 to 6 and
            something broke. Write the commands to: get the values used in revision 5, get the values used in
            revision 6, get the manifest from revision 5, and then rollback to revision 5.
          functionSignature: "helm get values --revision / helm get manifest --revision / helm rollback"
          testCases:
            - input: "Get values from revision 5"
              output: "helm get values api --namespace production --revision 5"
            - input: "Get values from revision 6"
              output: "helm get values api --namespace production --revision 6"
            - input: "Get manifest from revision 5"
              output: "helm get manifest api --namespace production --revision 5"
            - input: "Rollback to revision 5"
              output: "helm rollback api 5 --namespace production"
          hints:
            - title: "\U0001F914 Think about it"
              content: >-
                The <code>--revision</code> flag on <code>helm get</code> subcommands lets you inspect any
                historical revision, not just the current one. This is essential for debugging regressions.
            - title: "\U0001F4A1 Hint"
              content: >-
                Use <code>helm get values --revision N</code> and <code>helm get manifest --revision N</code>
                to compare what changed between two revisions.
            - title: "\U0001F527 Pattern"
              content: |-
                <pre>1. helm get values &lt;name&gt; --revision &lt;old&gt; --namespace &lt;ns&gt;
                2. helm get values &lt;name&gt; --revision &lt;new&gt; --namespace &lt;ns&gt;
                3. helm get manifest &lt;name&gt; --revision &lt;old&gt; --namespace &lt;ns&gt;
                4. helm rollback &lt;name&gt; &lt;old&gt; --namespace &lt;ns&gt;</pre>
          solution: |-
            # Get values from the previous good revision
            helm get values api --namespace production --revision 5

            # Get values from the broken revision
            helm get values api --namespace production --revision 6

            # Get the manifest from the good revision to see what changed
            helm get manifest api --namespace production --revision 5

            # Rollback to the good revision
            helm rollback api 5 --namespace production
          difficulty: 3
        - id: v5
          title: Chart Inspection Before Install
          description: >-
            You are evaluating the <code>bitnami/rabbitmq</code> chart for the first time. Write the commands to:
            add the Bitnami repo, update it, show the chart metadata, show the default values, and render the
            templates locally to review them before installing.
          functionSignature: "helm repo add / update / show chart / show values / template"
          testCases:
            - input: "Add and update the Bitnami repo"
              output: "helm repo add bitnami https://charts.bitnami.com/bitnami && helm repo update"
            - input: "Show chart metadata"
              output: "helm show chart bitnami/rabbitmq"
            - input: "Show default values"
              output: "helm show values bitnami/rabbitmq"
            - input: "Render templates locally"
              output: "helm template my-rabbitmq bitnami/rabbitmq"
          hints:
            - title: "\U0001F914 Think about it"
              content: >-
                Before installing an unfamiliar chart, best practice is to inspect its metadata, default values,
                and rendered templates. This helps you understand what resources will be created.
            - title: "\U0001F4A1 Hint"
              content: >-
                Use <code>helm show chart</code> for metadata (version, description, dependencies),
                <code>helm show values</code> for the full default values.yaml, and <code>helm template</code>
                to see the exact Kubernetes manifests that would be generated.
            - title: "\U0001F527 Pattern"
              content: |-
                <pre>1. helm repo add &lt;name&gt; &lt;url&gt; && helm repo update
                2. helm show chart &lt;chart&gt;  (metadata)
                3. helm show values &lt;chart&gt;  (defaults)
                4. helm template &lt;name&gt; &lt;chart&gt;  (rendered YAML)</pre>
          solution: |-
            # Add the Bitnami repository and update
            helm repo add bitnami https://charts.bitnami.com/bitnami
            helm repo update

            # Inspect chart metadata
            helm show chart bitnami/rabbitmq

            # Review default values
            helm show values bitnami/rabbitmq

            # Render templates locally to review
            helm template my-rabbitmq bitnami/rabbitmq
          difficulty: 2
        - id: v6
          title: Namespace Mismatch Debug
          description: >-
            You ran <code>helm list</code> and do not see your release <code>my-app</code>, but you know it was
            installed. Write the commands to: list releases in all namespaces to find it, check its status once
            found in the <code>monitoring</code> namespace, and get its currently applied values.
          functionSignature: "helm list -A / status / get values"
          testCases:
            - input: "List releases in all namespaces"
              output: "helm list --all-namespaces"
            - input: "Check status in monitoring namespace"
              output: "helm status my-app --namespace monitoring"
            - input: "Get values in monitoring namespace"
              output: "helm get values my-app --namespace monitoring"
          hints:
            - title: "\U0001F914 Think about it"
              content: >-
                Helm releases are namespace-scoped. If you run <code>helm list</code> without <code>--namespace</code>,
                it only shows releases in the current context's namespace. A common mistake is forgetting which
                namespace a release was installed into.
            - title: "\U0001F4A1 Hint"
              content: >-
                Use <code>helm list --all-namespaces</code> (or <code>-A</code>) to find releases across all
                namespaces. Once you identify the correct namespace, include <code>--namespace</code> in all
                subsequent commands.
            - title: "\U0001F527 Pattern"
              content: |-
                <pre>1. helm list --all-namespaces  (find the release)
                2. helm status &lt;name&gt; --namespace &lt;ns&gt;  (check health)
                3. helm get values &lt;name&gt; --namespace &lt;ns&gt;  (inspect config)</pre>
          solution: |-
            # Find the release across all namespaces
            helm list --all-namespaces

            # Check status in the correct namespace
            helm status my-app --namespace monitoring

            # Get the applied values
            helm get values my-app --namespace monitoring
          difficulty: 2
        - id: v7
          title: Upgrade Drift Detection
          description: >-
            Release <code>web</code> in namespace <code>production</code> may have drifted from its Helm-managed state
            (someone edited resources manually). Write the commands to: get the Helm-managed manifest, render what the
            chart would produce with current values, and perform a dry-run upgrade to detect differences.
          functionSignature: "helm get manifest / get values / template / upgrade --dry-run"
          testCases:
            - input: "Get the currently deployed manifest"
              output: "helm get manifest web --namespace production"
            - input: "Get the current release values"
              output: "helm get values web --namespace production"
            - input: "Dry-run upgrade to see what would change"
              output: "helm upgrade web bitnami/nginx --namespace production --dry-run"
          hints:
            - title: "\U0001F914 Think about it"
              content: >-
                Helm stores the last-applied manifest. If someone modifies resources directly with
                <code>kubectl edit</code>, the live state diverges from what Helm knows about. A dry-run
                upgrade can reveal these differences.
            - title: "\U0001F4A1 Hint"
              content: >-
                Compare <code>helm get manifest</code> (what Helm last applied) with the output of
                <code>helm upgrade --dry-run</code> (what Helm would apply now) to detect drift.
            - title: "\U0001F527 Pattern"
              content: |-
                <pre>1. helm get manifest &lt;name&gt; --namespace &lt;ns&gt;  (last applied)
                2. helm get values &lt;name&gt; --namespace &lt;ns&gt;  (current values)
                3. helm upgrade &lt;name&gt; &lt;chart&gt; --namespace &lt;ns&gt; --dry-run  (would-apply)</pre>
          solution: |-
            # Get the Helm-managed manifest (last applied state)
            helm get manifest web --namespace production

            # Get the current release values
            helm get values web --namespace production

            # Dry-run upgrade to see what Helm would apply now
            helm upgrade web bitnami/nginx --namespace production --dry-run
          difficulty: 3
        - id: v8
          title: Recover from Interrupted Upgrade
          description: >-
            Release <code>backend</code> in namespace <code>production</code> shows status <code>pending-upgrade</code>
            because the upgrade was interrupted. Write the commands to: check the history to find the last successful
            revision, rollback to that revision (assume it was revision 3), verify the status is <code>deployed</code>,
            and then retry the upgrade with <code>--atomic</code> for safety.
          functionSignature: "helm history / rollback / status / upgrade --atomic"
          testCases:
            - input: "Check history for last successful revision"
              output: "helm history backend --namespace production"
            - input: "Rollback to revision 3"
              output: "helm rollback backend 3 --namespace production"
            - input: "Verify status is deployed"
              output: "helm status backend --namespace production"
            - input: "Retry upgrade with atomic flag"
              output: "helm upgrade backend bitnami/nginx --namespace production --atomic --timeout 5m"
          hints:
            - title: "\U0001F914 Think about it"
              content: >-
                A <code>pending-upgrade</code> status means the upgrade never completed. You need to rollback to
                a known-good state before retrying. The <code>--atomic</code> flag ensures that if the next
                upgrade fails, it will automatically rollback.
            - title: "\U0001F4A1 Hint"
              content: >-
                Use <code>helm history</code> to identify the last <code>deployed</code> revision. Rollback to
                it, verify health, then retry with <code>--atomic</code> for automatic rollback on failure.
            - title: "\U0001F527 Pattern"
              content: |-
                <pre>1. helm history &lt;name&gt; --namespace &lt;ns&gt;
                2. helm rollback &lt;name&gt; &lt;revision&gt; --namespace &lt;ns&gt;
                3. helm status &lt;name&gt; --namespace &lt;ns&gt;
                4. helm upgrade &lt;name&gt; &lt;chart&gt; --namespace &lt;ns&gt; --atomic --timeout &lt;duration&gt;</pre>
          solution: |-
            # Check history to find the last successful revision
            helm history backend --namespace production

            # Rollback to the last known-good revision
            helm rollback backend 3 --namespace production

            # Verify the rollback succeeded
            helm status backend --namespace production

            # Retry the upgrade with atomic flag for safety
            helm upgrade backend bitnami/nginx --namespace production --atomic --timeout 5m
          difficulty: 3
